<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd">
	
	<import resource="../momime.common.spring/momime-common-beans.xml"/>
	
	<!-- General XSD objects (may move these into common project at some stage) -->
	
	<bean id="domImplementationRegistry" class="org.w3c.dom.bootstrap.DOMImplementationRegistry" factory-method="newInstance" />
	
	<bean id="serverXsdResourceResolver" class="momime.server.database.ServerXsdResourceResolver">
		<constructor-arg ref="domImplementationRegistry" />
	</bean>
	
	<bean id="schemaFactory" class="javax.xml.validation.SchemaFactory" factory-method="newInstance">
		<constructor-arg value="http://www.w3.org/2001/XMLSchema" />
		<property name="resourceResolver" ref="serverXsdResourceResolver" />
	</bean>	
	
	<!-- Client config XML -->
	
	<bean id="clientConfigSchema" class="javax.xml.validation.Schema" factory-bean="schemaFactory" factory-method="newSchema">
		<constructor-arg value="/momime.client.config/MoMIMEClientConfig.xsd"/>
	</bean>
	
	<bean id="clientConfigJaxbContext" class="javax.xml.bind.JAXBContext" factory-method="newInstance">
		<constructor-arg>
    		<list>
    			<value>momime.client.config.v0_9_5.MomImeClientConfig</value>
    		</list>
   		</constructor-arg>
	</bean>
	
	<bean id="clientConfigUnmarshaller" class="javax.xml.bind.Unmarshaller" factory-bean="clientConfigJaxbContext" factory-method="createUnmarshaller">
		<property name="schema" ref="clientConfigSchema" />
	</bean>

	<bean id="clientConfig" class="momime.client.config.v0_9_5.MomImeClientConfig" factory-bean="clientConfigUnmarshaller" factory-method="unmarshal">
		<constructor-arg value="MoMIMEClientConfig.xml" />
	</bean>

	<bean id="clientConfigMarshaller" class="javax.xml.bind.Marshaller" factory-bean="clientConfigJaxbContext" factory-method="createMarshaller">
		<property name="schema" ref="clientConfigSchema" />
	</bean>

	<bean id="configureClientConfigMarshaller" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
		<property name="targetObject" ref="clientConfigMarshaller" />
		<property name="targetMethod" value="setProperty" />
		<property name="arguments">
			<list>
				<value>jaxb.formatted.output</value>
				<value type="java.lang.Boolean">true</value>
			</list>
		</property>
	</bean>
	
	<!-- Graphics XML -->
	
	<bean id="graphicsDatabaseSchema" class="javax.xml.validation.Schema" factory-bean="schemaFactory" factory-method="newSchema">
		<constructor-arg value="/momime.client.graphics/MoMIMEGraphicsDatabase_NoServerXsdLink.xsd" />		<!-- Otherwise XSD validation expects to find serverDatabase element in graphics XML -->
	</bean>
	
	<bean id="graphicsDatabaseJaxbContext" class="javax.xml.bind.JAXBContext" factory-method="newInstance">
		<constructor-arg>
    		<list>
    			<value>momime.client.graphics.database.v0_9_5.GraphicsDatabase</value>
    		</list>
   		</constructor-arg>
	</bean>
	
	<bean id="graphicsDatabaseFactory" class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean" >
		<property name="serviceLocatorInterface" value="momime.client.graphics.database.GraphicsDatabaseFactory" />
	</bean>			
	
	<bean id="graphicsDatabaseObjectFactory" class="momime.client.graphics.database.GraphicsDatabaseObjectFactory">		<!-- Creates GraphicsDatabaseExImpl instead of GraphicsDatabase -->
		<property name="factory" ref="graphicsDatabaseFactory" />
	</bean>
		
	<bean id="graphicsDatabaseUnmarshaller" class="javax.xml.bind.Unmarshaller" factory-bean="graphicsDatabaseJaxbContext" factory-method="createUnmarshaller">
		<property name="schema" ref="graphicsDatabaseSchema" />
	</bean>

	<bean id="configureGraphicsDatabaseUnmarshaller" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
		<property name="targetObject" ref="graphicsDatabaseUnmarshaller" />
		<property name="targetMethod" value="setProperty" />
		<property name="arguments">
			<list>
				<value>com.sun.xml.bind.ObjectFactory</value>
				<array>
					<ref bean="graphicsDatabaseObjectFactory" />
				</array>
			</list>
		</property>
	</bean>

	<bean id="graphicsDatabase" class="momime.client.graphics.database.GraphicsDatabaseExImpl" factory-bean="graphicsDatabaseUnmarshaller" factory-method="unmarshal" init-method="buildMapsAndRunConsistencyChecks">
		<constructor-arg value="#{clientConfig.graphicsXmlFilename}" />
		<property name="memoryBuildingUtils" ref="memoryBuildingUtils" />
	</bean>
	
	<bean id="smoothedTileType" class="momime.client.graphics.database.SmoothedTileTypeEx" scope="prototype">
		<property name="randomUtils" ref="randomUtils" />
	</bean>

	<bean id="tileSet" class="momime.client.graphics.database.TileSetEx" scope="prototype">
		<property name="utils" ref="uiUtils" />
	</bean>

	<bean id="mapFeature" class="momime.client.graphics.database.MapFeatureEx" scope="prototype">
		<property name="utils" ref="uiUtils" />
	</bean>

	<bean id="animation" class="momime.client.graphics.database.AnimationEx" scope="prototype">
		<property name="utils" ref="uiUtils" />
	</bean>
	
	<!-- Language XML -->

	<bean id="languageDatabaseSchema" class="javax.xml.validation.Schema" factory-bean="schemaFactory" factory-method="newSchema">
		<constructor-arg value="/momime.client.language/MoMIMELanguageDatabase_NoServerXsdLink.xsd" />		<!-- Otherwise XSD validation expects to find serverDatabase element in language XML -->
	</bean>
	
	<bean id="languageDatabaseJaxbContext" class="javax.xml.bind.JAXBContext" factory-method="newInstance">
		<constructor-arg>
    		<list>
    			<value>momime.client.language.database.v0_9_5.LanguageDatabase</value>
    		</list>
   		</constructor-arg>
	</bean>
	
	<bean id="languageDatabaseFactory" class="momime.client.language.database.LanguageDatabaseFactory" />		<!-- Creates LanguageDatabaseExImpl instead of LanguageDatabase -->
	
	<bean id="languageDatabaseUnmarshaller" class="javax.xml.bind.Unmarshaller" factory-bean="languageDatabaseJaxbContext" factory-method="createUnmarshaller">
		<property name="schema" ref="languageDatabaseSchema" />
	</bean>

	<bean id="configureLanguageDatabaseUnmarshaller" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
		<property name="targetObject" ref="languageDatabaseUnmarshaller" />
		<property name="targetMethod" value="setProperty" />
		<property name="arguments">
			<list>
				<value>com.sun.xml.bind.ObjectFactory</value>
				<array>
					<ref bean="languageDatabaseFactory" />
				</array>
			</list>
		</property>
	</bean>

	<bean id="languageDatabase" class="momime.client.language.database.LanguageDatabaseExImpl" factory-bean="languageDatabaseUnmarshaller" factory-method="unmarshal" init-method="buildMaps">
		<constructor-arg type="java.io.File" value="#{clientConfig.pathToLanguageXmlFiles + clientConfig.chosenLanguage + '.Master of Magic Language.xml'}" />
	</bean>
	
	<bean id="languageHolder" class ="momime.client.language.database.LanguageDatabaseHolder">
		<property name="language" ref="languageDatabase" />
	</bean>
	
	<!-- Create extended versions of server to clientmessages which include message implementations -->

	<bean id="momClientServerToClientServerFactory" class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean" >
		<property name="serviceLocatorInterface" value="momime.client.messages.process.ServerToClientMessagesFactory" />
	</bean>			

	<bean id="momClientServerToClientObjectFactory" class="momime.client.messages.process.ServerToClientMessagesObjectFactory">
		<property name="factory" ref="momClientServerToClientServerFactory" />
	</bean>

	<bean id="newGameDatabaseMessage" class="momime.client.messages.process.NewGameDatabaseMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="connectToServerUI" ref="connectToServerUI" />
	</bean>

	<bean id="chosenWizardMessage" class="momime.client.messages.process.ChosenWizardMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="newGameUI" ref="newGameUI" />
	</bean>

	<bean id="replacePicksMessage" class="momime.client.messages.process.ReplacePicksMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
	</bean>
	
	<bean id="chooseInitialSpellsNowMessage" class="momime.client.messages.process.ChooseInitialSpellsNowMessageImpl" scope="prototype">
		<property name="newGameUI" ref="newGameUI" />
	</bean>
	
	<bean id="chooseYourRaceNowMessage" class="momime.client.messages.process.ChooseYourRaceNowMessageImpl" scope="prototype">
		<property name="newGameUI" ref="newGameUI" />
	</bean>

	<bean id="yourRaceIsOkMessage" class="momime.client.messages.process.YourRaceIsOkMessageImpl" scope="prototype" >
		<property name="newGameUI" ref="newGameUI" />
	</bean>
	
	<bean id="startGameProgressMessage" class="momime.client.messages.process.StartGameProgressMessageImpl" scope="prototype" />

	<bean id="chosenStandardPhotoMessage" class="momime.client.messages.process.ChosenStandardPhotoMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
	</bean>

	<bean id="fullSpellListMessage" class="momime.client.messages.process.FullSpellListMessageImpl" scope="prototype" >
		<property name="client" ref="momClient" />
		<property name="spellUtils" ref="spellUtils" />
	</bean>

	<bean id="startGameMessage" class="momime.client.messages.process.StartGameMessageImpl" scope="prototype">
		<property name="newGameUI" ref="newGameUI" />
		<property name="overlandMapUI" ref="overlandMapUI" />
		<property name="mainMenuUI" ref="mainMenuUI" />
	</bean>

	<bean id="updateGlobalEconomyMessage" class="momime.client.messages.process.UpdateGlobalEconomyMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="overlandMapRightHandPanel" ref="overlandMapRightHandPanel" />
	</bean>

	<bean id="updateDamageTakenAndExperienceMessage" class="momime.client.messages.process.UpdateDamageTakenAndExperienceMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="unitUtils" ref="unitUtils" />
	</bean>

	<bean id="erasePendingMovementsMessage" class="momime.client.messages.process.ErasePendingMovementsMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
	</bean>

	<bean id="setCurrentPlayerMessage" class="momime.client.messages.process.SetCurrentPlayerMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="overlandMapUI" ref="overlandMapUI" />
		<property name="cityCalculations" ref="cityCalculations" />
		<property name="unitUtils" ref="unitUtils" />
		<property name="overlandMapProcessing" ref="overlandMapProcessing" />
	</bean>

	<bean id="endOfContinuedMovementMessage" class="momime.client.messages.process.EndOfContinuedMovementMessageImpl" scope="prototype">
		<property name="overlandMapProcessing" ref="overlandMapProcessing" />
	</bean>

	<bean id="overlandMovementTypesMessage" class="momime.client.messages.process.OverlandMovementTypesMessageImpl" scope="prototype">
		<property name="overlandMapUI" ref="overlandMapUI" />
	</bean>
	
	<bean id="updateRemainingResearchCostMessage" class="momime.client.messages.process.UpdateRemainingResearchCostMessageImpl" scope="prototype" />
	<bean id="selectNextUnitToMoveOverlandMessage" class="momime.client.messages.process.SelectNextUnitToMoveOverlandMessageImpl" scope="prototype" />
	<bean id="textPopupMessage" class="momime.client.messages.process.TextPopupMessageImpl" scope="prototype" />
	
	<bean id="updateNodeLairTowerUnitIDMessage" class="momime.client.messages.process.UpdateNodeLairTowerUnitIDMessageImpl" scope="prototype" />
	<bean id="startCombatMessage" class="momime.client.messages.process.StartCombatMessageImpl" scope="prototype" />
	<bean id="pendingMovementMessage" class="momime.client.messages.process.PendingMovementMessageImpl" scope="prototype" />
	<bean id="playerCombatRequestStatusMessage" class="momime.client.messages.process.PlayerCombatRequestStatusMessageImpl" scope="prototype" />
	<bean id="pendingSaleMessage" class="momime.client.messages.process.PendingSaleMessageImpl" scope="prototype" />
	<bean id="updateOverlandMovementRemainingMessage" class="momime.client.messages.process.UpdateOverlandMovementRemainingMessageImpl" scope="prototype" />
	<bean id="damageCalculationMessage" class="momime.client.messages.process.DamageCalculationMessageImpl" scope="prototype" />
	<bean id="startSimultaneousTurnMessage" class="momime.client.messages.process.StartSimultaneousTurnMessageImpl" scope="prototype" />
	<bean id="addNewTurnMessagesMessage" class="momime.client.messages.process.AddNewTurnMessagesMessageImpl" scope="prototype" />
	<bean id="taxRateChangedMessage" class="momime.client.messages.process.TaxRateChangedMessageImpl" scope="prototype" />
	<bean id="scheduledCombatWalkInWithoutAFightMessage" class="momime.client.messages.process.ScheduledCombatWalkInWithoutAFightMessageImpl" scope="prototype" />
	<bean id="moveUnitStackOverlandMessage" class="momime.client.messages.process.MoveUnitStackOverlandMessageImpl" scope="prototype" />
	<bean id="yourPhotoIsOkMessage" class="momime.client.messages.process.YourPhotoIsOkMessageImpl" scope="prototype" />
	<bean id="foundLairNodeTowerMessage" class="momime.client.messages.process.FoundLairNodeTowerMessageImpl" scope="prototype" />
	<bean id="addCombatAreaEffectMessage" class="momime.client.messages.process.AddCombatAreaEffectMessageImpl" scope="prototype" />
	<bean id="addMaintainedSpellMessage" class="momime.client.messages.process.AddMaintainedSpellMessageImpl" scope="prototype" />
	<bean id="showListAndOtherScheduledCombatsMessage" class="momime.client.messages.process.ShowListAndOtherScheduledCombatsMessageImpl" scope="prototype" />
	<bean id="setCombatPlayerMessage" class="momime.client.messages.process.SetCombatPlayerMessageImpl" scope="prototype" />
	<bean id="killUnitMessage" class="momime.client.messages.process.KillUnitMessageImpl" scope="prototype" />
	<bean id="chosenCustomPhotoMessage" class="momime.client.messages.process.ChosenCustomPhotoMessageImpl" scope="prototype" />
	<bean id="setSpecialOrderMessage" class="momime.client.messages.process.SetSpecialOrderMessageImpl" scope="prototype" />
	<bean id="updateOtherScheduledCombatsMessage" class="momime.client.messages.process.UpdateOtherScheduledCombatsMessageImpl" scope="prototype" />
	<bean id="addScheduledCombatMessage" class="momime.client.messages.process.AddScheduledCombatMessageImpl" scope="prototype" />
	<bean id="applyDamageMessage" class="momime.client.messages.process.ApplyDamageMessageImpl" scope="prototype" />
	<bean id="overlandCastQueuedMessage" class="momime.client.messages.process.OverlandCastQueuedMessageImpl" scope="prototype" />
	<bean id="destroyBuildingMessage" class="momime.client.messages.process.DestroyBuildingMessageImpl" scope="prototype" />
	<bean id="setUnitIntoOrTakeUnitOutOfCombatMessage" class="momime.client.messages.process.SetUnitIntoOrTakeUnitOutOfCombatMessageImpl" scope="prototype" />
	<bean id="spellResearchChangedMessage" class="momime.client.messages.process.SpellResearchChangedMessageImpl" scope="prototype" />
	<bean id="switchOffMaintainedSpellMessage" class="momime.client.messages.process.SwitchOffMaintainedSpellMessageImpl" scope="prototype" />
	<bean id="removeQueuedSpellMessage" class="momime.client.messages.process.RemoveQueuedSpellMessageImpl" scope="prototype" />
	<bean id="updateUnitNameMessage" class="momime.client.messages.process.UpdateUnitNameMessageImpl" scope="prototype" />
	<bean id="updateProductionSoFarMessage" class="momime.client.messages.process.UpdateProductionSoFarMessageImpl" scope="prototype" />
	<bean id="moveUnitInCombatMessage" class="momime.client.messages.process.MoveUnitInCombatMessageImpl" scope="prototype" />
	<bean id="combatEndedMessage" class="momime.client.messages.process.CombatEndedMessageImpl" scope="prototype" />
	<bean id="onePlayerSimultaneousTurnDoneMessage" class="momime.client.messages.process.OnePlayerSimultaneousTurnDoneMessageImpl" scope="prototype" />
	<bean id="updateManaSpentOnCastingCurrentSpellMessage" class="momime.client.messages.process.UpdateManaSpentOnCastingCurrentSpellMessageImpl" scope="prototype" />
	<bean id="broadcastChatMessage" class="momime.client.messages.process.BroadcastChatMessageImpl" scope="prototype" />
	<bean id="cancelCombatAreaEffectMessage" class="momime.client.messages.process.CancelCombatAreaEffectMessageImpl" scope="prototype" />
	<bean id="askForCaptureCityDecisionMessage" class="momime.client.messages.process.AskForCaptureCityDecisionMessageImpl" scope="prototype" />
	<bean id="updateUnitToAliveMessage" class="momime.client.messages.process.UpdateUnitToAliveMessageImpl" scope="prototype" />
	
	<bean id="updateTerrainMessage" class="momime.client.messages.process.UpdateTerrainMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="overlandMapUI" ref="overlandMapUI" />
		<property name="overlandMapBitmapGenerator" ref="overlandMapBitmapGenerator" />
		<property name="booleanMapAreaOperations3D" ref="booleanMapAreaOperations3D" />
	</bean>

	<bean id="updateCityMessage" class="momime.client.messages.process.UpdateCityMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="overlandMapUI" ref="overlandMapUI" />
		<property name="prototypeFrameCreator" ref="prototypeFrameCreator" />
	</bean>

	<bean id="addBuildingMessage" class="momime.client.messages.process.AddBuildingMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="overlandMapUI" ref="overlandMapUI" />
	</bean>

	<bean id="addUnitMessage" class="momime.client.messages.process.AddUnitMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="unitUtils" ref="unitUtils" />
	</bean>

	<bean id="fogOfWarVisibleAreaChangedMessage" class="momime.client.messages.process.FogOfWarVisibleAreaChangedMessageImpl" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="factory" ref="momClientServerToClientServerFactory" />
		<property name="overlandMapUI" ref="overlandMapUI" />
	</bean>
	
	<!-- Version of the client -->
	
	<context:property-placeholder location="classpath:MoMIMEClientVersion.properties" />
	
	<!-- Singleton beans for client -->
	
	<bean id="multiplayerSessionClientServerToClientObjectFactory" class="com.ndg.multiplayer.client.messages.process.MultiplayerSessionClientServerToClientObjectFactory" />

	<bean id="clientDatabaseFactory" class="momime.client.database.ClientDatabaseFactory" />	<!-- Creates ClientDatabaseExImpl instead of ClientDatabase -->
	
	<bean id="momClient" class="momime.client.MomClientImpl" init-method="start">
		<property name="serverPort" value="18250" />
		<property name="processMessagesOnSwingEventDispatcherThread" value="true" />
		<property name="clientToServerContext" ref="clientToServerJaxbContext" />
		<property name="serverToClientContext" ref="serverToClientJaxbContext" />
		<property name="serverToClientContextFactoryArray">
			<array>
				<ref bean="multiplayerSessionClientServerToClientObjectFactory" />
				<ref bean="momClientServerToClientObjectFactory" />
				<ref bean="clientDatabaseFactory" />
				<ref bean="objectFactoryMap" />
			</array>
		</property>
		<property name="mainMenuUI" ref="mainMenuUI" />
		<property name="connectToServerUI" ref="connectToServerUI" />
		<property name="newGameUI" ref="newGameUI" />
		<property name="overlandMapBitmapGenerator" ref="overlandMapBitmapGenerator" />
		<property name="prototypeFrameCreator" ref="prototypeFrameCreator" />
		<property name="utils" ref="uiUtils" />
	</bean>
	
	<bean id="uiUtils" class="com.ndg.swing.NdgUIUtilsImpl" />
	
	<bean id="anim" class="momime.client.utils.AnimationControllerImpl">
		<property name="utils" ref="uiUtils" />
		<property name="graphicsDB" ref="graphicsDatabase" />
	</bean>
	
	<bean id="overlandMapClientUtils" class="momime.client.utils.OverlandMapClientUtilsImpl">
		<property name="coordinateSystemUtils" ref="coordinateSystemUtils" />
	</bean>

	<bean id="textUtils" class="momime.client.utils.TextUtilsImpl" />

	<bean id="resourceValueClientUtils" class="momime.client.utils.ResourceValueClientUtilsImpl">
		<property name="utils" ref="uiUtils" />
		<property name="graphicsDB" ref="graphicsDatabase" />
	</bean>
	
	<bean id="clientCityCalculations" class="momime.client.calculations.MomClientCityCalculationsImpl">
		<property name="client" ref="momClient" />
		<property name="memoryBuildingUtils" ref="memoryBuildingUtils" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="unrestReplacer" ref="unrestReplacer" />
		<property name="growthReplacer" ref="growthReplacer" />
		<property name="productionReplacer" ref="productionReplacer" />
	</bean>

	<bean id="clientUnitCalculations" class="momime.client.calculations.MomClientUnitCalculationsImpl">
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="client" ref="momClient" />
		<property name="unitUtils" ref="unitUtils" />
	</bean>

	<bean id="overlandMapBitmapGenerator" class="momime.client.calculations.OverlandMapBitmapGeneratorImpl">
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="coordinateSystemUtils" ref="coordinateSystemUtils" />
		<property name="utils" ref="uiUtils" />
		<property name="playerColourImageGenerator" ref="playerColourImageGenerator" />
	</bean>
	
	<bean id="overlandMapProcessing" class="momime.client.process.OverlandMapProcessingImpl">
		<property name="client" ref="momClient" />
		<property name="unitUtils" ref="unitUtils" />
		<property name="pendingMovementUtils" ref="pendingMovementUtils" />
		<property name="cityCalculations" ref="cityCalculations" />
		<property name="overlandMapUI" ref="overlandMapUI" />
		<property name="overlandMapRightHandPanel" ref="overlandMapRightHandPanel" />
	</bean>
	
	<bean id="playerColourImageGenerator" class="momime.client.ui.PlayerColourImageGeneratorImpl">
		<property name="client" ref="momClient" />
		<property name="utils" ref="uiUtils" />
	</bean>
	
	<!-- Language variable replacers -->
	
	<bean id="unrestReplacer" class="momime.client.language.replacer.CityUnrestLanguageVariableReplacerImpl">
		<property name="languageHolder" ref="languageHolder" />
		<property name="textUtils" ref="textUtils" />
	</bean>
	
	<bean id="growthReplacer" class="momime.client.language.replacer.CityGrowthRateLanguageVariableReplacerImpl">
		<property name="languageHolder" ref="languageHolder" />
		<property name="textUtils" ref="textUtils" />
	</bean>
	
	<bean id="productionReplacer" class="momime.client.language.replacer.CityProductionLanguageVariableReplacerImpl">
		<property name="languageHolder" ref="languageHolder" />
		<property name="textUtils" ref="textUtils" />
	</bean>

	<bean id="unitStatsReplacer" class="momime.client.language.replacer.UnitStatsLanguageVariableReplacerImpl">
		<property name="languageHolder" ref="languageHolder" />
		<property name="client" ref="momClient" />
		<property name="unitUtils" ref="unitUtils" />
		<property name="unitCalculations" ref="unitCalculations" />
	</bean>
	
	<!-- Fonts
		Having to use same font for medium and large sizes, because I can't find anywhere a decent
		Old English / Blackletter style font with sufficient foreign char support -->
	
	<bean id="fontFactory" class="momime.client.ui.fonts.FontFactoryImpl" />
	
	<bean id="mediumFontTTF" class="java.awt.Font" factory-bean="fontFactory" factory-method="loadFont">
		<constructor-arg value="/momime.client.ui.fonts/KingthingsPetrock.ttf" />
	</bean>

	<bean id="largeFont" class="java.awt.Font" factory-bean="mediumFontTTF" factory-method="deriveFont">
		<constructor-arg value="20.0" />
	</bean>

	<bean id="mediumFont" class="java.awt.Font" factory-bean="mediumFontTTF" factory-method="deriveFont">
		<constructor-arg value="15.0" />
	</bean>

	<bean id="smallFontTTF" class="java.awt.Font" factory-bean="fontFactory" factory-method="loadFont">
		<constructor-arg value="/momime.client.ui.fonts/Aclonica.ttf" />
	</bean>

	<bean id="smallFont" class="java.awt.Font" factory-bean="smallFontTTF" factory-method="deriveFont">
		<constructor-arg value="10.0" />
	</bean>
	
	<!-- UI components -->

	<bean id="mainMenuUI" class="momime.client.ui.frames.MainMenuUI">
		<property name="version" value="${momime.client.version}" />
		<property name="largeFont" ref="largeFont" />
		<property name="mediumFont" ref="mediumFont" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="chooseLanguageUI" ref="chooseLanguageUI" />
		<property name="connectToServerUI" ref="connectToServerUI" />
		<property name="newGameUI" ref="newGameUI" />
		<property name="client" ref="momClient" />
		<property name="anim" ref="anim" />
	</bean>

	<bean id="chooseLanguageUI" class="momime.client.ui.frames.ChooseLanguageUI">
		<property name="largeFont" ref="largeFont" />
		<property name="smallFont" ref="smallFont" />
		<property name="mainMenuUI" ref="mainMenuUI" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="pathToLanguageXmlFiles" value="#{clientConfig.pathToLanguageXmlFiles}" />
		<property name="languageDatabaseUnmarshaller" ref="languageDatabaseUnmarshaller" />
		<property name="clientConfig" ref="clientConfig" />
		<property name="clientConfigMarshaller" ref="clientConfigMarshaller" />
	</bean>
	
	<bean id="connectToServerUI" class="momime.client.ui.frames.ConnectToServerUI">
		<property name="largeFont" ref="largeFont" />
		<property name="mediumFont" ref="mediumFont" />
		<property name="smallFont" ref="smallFont" />
		<property name="mainMenuUI" ref="mainMenuUI" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="client" ref="momClient" />
		<property name="prototypeFrameCreator" ref="prototypeFrameCreator" />
	</bean>
	
	<bean id="newGameUI" class="momime.client.ui.frames.NewGameUI">
		<property name="largeFont" ref="largeFont" />
		<property name="mediumFont" ref="mediumFont" />
		<property name="smallFont" ref="smallFont" />
		<property name="mainMenuUI" ref="mainMenuUI" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="playerPickUtils" ref="playerPickUtils" />
		<property name="randomUtils" ref="randomUtils" />
	</bean>
	
	<bean id="overlandMapRightHandPanel" class="momime.client.ui.panels.OverlandMapRightHandPanel">
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="largeFont" ref="largeFont" />
		<property name="mediumFont" ref="mediumFont" />
		<property name="smallFont" ref="smallFont" />
		<property name="textUtils" ref="textUtils" />
		<property name="client" ref="momClient" />
		<property name="resourceValueUtils" ref="resourceValueUtils" />
		<property name="pendingMovementUtils" ref="pendingMovementUtils" />
		<property name="overlandMapProcessing" ref="overlandMapProcessing" />
		<property name="uiComponentFactory" ref="uiComponentFactory" />
		<property name="prototypeFrameCreator" ref="prototypeFrameCreator" />
	</bean>

	<bean id="overlandMapUI" class="momime.client.ui.frames.OverlandMapUI">
		<property name="smallFont" ref="smallFont" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="memoryGridCellUtils" ref="memoryGridCellUtils" />
		<property name="utils" ref="uiUtils" />
		<property name="prototypeFrameCreator" ref="prototypeFrameCreator" />
		<property name="overlandMapBitmapGenerator" ref="overlandMapBitmapGenerator" />
		<property name="overlandMapRightHandPanel" ref="overlandMapRightHandPanel" />
		<property name="playerColourImageGenerator" ref="playerColourImageGenerator" />
	</bean>

	<!-- Prototype UI components -->

	<bean id="buildingListCellRenderer" class="momime.client.ui.renderer.BuildingListCellRenderer" scope="prototype">
		<property name="languageHolder" ref="languageHolder" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="anim" ref="anim" />
	</bean>

	<bean id="unitSkillListCellRenderer" class="momime.client.ui.renderer.UnitSkillListCellRenderer" scope="prototype">
		<property name="languageHolder" ref="languageHolder" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="utils" ref="uiUtils" />
		<property name="unitUtils" ref="unitUtils" />
		<property name="client" ref="momClient" />
		<property name="unitStatsReplacer" ref="unitStatsReplacer" />
	</bean>

	<bean id="uiComponentFactory" class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean" >
		<property name="serviceLocatorInterface" value="momime.client.ui.components.UIComponentFactory" />
	</bean>

	<bean id="selectUnitButton" class="momime.client.ui.components.SelectUnitButton" scope="prototype">
		<property name="utils" ref="uiUtils" />
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="playerColourImageGenerator" ref="playerColourImageGenerator" />
		<property name="unitUtils" ref="unitUtils" />
	</bean>
	
	<!-- Prototype UI frames -->
	
	<bean id="prototypeFrameCreator" class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean" >
		<property name="serviceLocatorInterface" value="momime.client.ui.frames.PrototypeFrameCreator" />
	</bean>
	
	<bean id="messageBoxUI" class="momime.client.ui.frames.MessageBoxUI" scope="prototype">
		<property name="smallFont" ref="smallFont" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
	</bean>
	
	<bean id="calculationBoxUI" class="momime.client.ui.frames.CalculationBoxUI" scope="prototype">
		<property name="smallFont" ref="smallFont" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
	</bean>
	
	<bean id="editStringUI" class="momime.client.ui.frames.EditStringUI" scope="prototype">
		<property name="largeFont" ref="largeFont" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="client" ref="momClient" />
	</bean>
	
	<bean id="cityViewPanel" class="momime.client.ui.panels.CityViewPanel" scope="prototype">	
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="utils" ref="uiUtils" />
		<property name="memoryBuildingUtils" ref="memoryBuildingUtils" />
		<property name="memoryMaintainedSpellUtils" ref="memoryMaintainedSpellUtils" />
		<property name="overlandMapClientUtils" ref="overlandMapClientUtils" />
		<property name="anim" ref="anim" />
	</bean>
	
	<bean id="cityViewUI" class="momime.client.ui.frames.CityViewUI" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="largeFont" ref="largeFont" />
		<property name="mediumFont" ref="mediumFont" />
		<property name="smallFont" ref="smallFont" />
		<property name="overlandMapUI" ref="overlandMapUI" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="textUtils" ref="textUtils" />
		<property name="cityCalculations" ref="cityCalculations" />
		<property name="clientCityCalculations" ref="clientCityCalculations" />
		<property name="resourceValueClientUtils" ref="resourceValueClientUtils" />
		<property name="prototypeFrameCreator" ref="prototypeFrameCreator" />
		<property name="anim" ref="anim" />
		<property name="cityViewPanel" ref="cityViewPanel" />									<!-- So Spring will create and inject a new cityViewPanel for each cityViewUI -->
	</bean>

	<bean id="unitInfoPanel" class="momime.client.ui.panels.UnitInfoPanel" scope="prototype">
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="mediumFont" ref="mediumFont" />
		<property name="smallFont" ref="smallFont" />
		<property name="textUtils" ref="textUtils" />
		<property name="resourceValueClientUtils" ref="resourceValueClientUtils" />
		<property name="anim" ref="anim" />
		<property name="clientCityCalculations" ref="clientCityCalculations" />
		<property name="client" ref="momClient" />
		<property name="unitUtils" ref="unitUtils" />
		<property name="unitCalculations" ref="unitCalculations" />
		<property name="clientUnitCalculations" ref="clientUnitCalculations" />
		<property name="unitSkillListCellRenderer" ref="unitSkillListCellRenderer" />		<!-- So Spring will create and inject a new skill list renderer for each unitInfoPanel -->
	</bean>	

	<bean id="changeConstructionUI" class="momime.client.ui.frames.ChangeConstructionUI" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="graphicsDB" ref="graphicsDatabase" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="mediumFont" ref="mediumFont" />
		<property name="smallFont" ref="smallFont" />
		<property name="memoryBuildingUtils" ref="memoryBuildingUtils" />
		<property name="cityCalculations" ref="cityCalculations" />
		<property name="unitUtils" ref="unitUtils" />
		<property name="unitCalculations" ref="unitCalculations" />
		<property name="anim" ref="anim" />
		<property name="buildingListCellRenderer" ref="buildingListCellRenderer" />		<!-- So Spring will create and inject a new building list renderer for each change construction UI -->
		<property name="unitInfoPanel" ref="unitInfoPanel" />										<!-- So Spring will create and inject a new unitInfoPanel for each changeConstructionUI -->
	</bean>
	
	<bean id="unitInfoUI" class="momime.client.ui.frames.UnitInfoUI" scope="prototype">
		<property name="client" ref="momClient" />
		<property name="languageHolder" ref="languageHolder" />
		<property name="languageChangeMaster" ref="chooseLanguageUI" />
		<property name="utils" ref="uiUtils" />
		<property name="overlandMapUI" ref="overlandMapUI" />
		<property name="unitInfoPanel" ref="unitInfoPanel" />										<!-- So Spring will create and inject a new unitInfoPanel for each unitInfoUI -->
	</bean>
	
</beans>